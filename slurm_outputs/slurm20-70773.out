Wed Apr  5 14:34:23 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 525.85.05    Driver Version: 525.85.05    CUDA Version: 12.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:00:06.0 Off |                    0 |
| N/A   36C    P8     9W /  70W |      2MiB / 15360MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 14:34:23 up 8 days, 23:44,  3 users,  load average: 0.03, 0.12, 0.16
Using config: dmc_vision.”
echo Running task: dmc_walker_walk.”

Config:
logdir:                    /vol/bitbucket/jk3417/explainable-mbhrl/logdir/20230405-143423  (str)
run:                       train_with_viz                                                  (str)
seed:                      0                                                               (int)
task:                      dmc_walker_walk                                                 (str)
env.amount:                4                                                               (int)
env.parallel:              process                                                         (str)
env.daemon:                False                                                           (bool)
env.repeat:                1                                                               (int)
env.size:                  [64, 64]                                                        (ints)
env.camera:                -1                                                              (int)
env.gray:                  False                                                           (bool)
env.length:                0                                                               (int)
env.discretize:            0                                                               (int)
env.lives:                 False                                                           (bool)
env.sticky:                True                                                            (bool)
env.episodic:              True                                                            (bool)
env.restart:               True                                                            (bool)
env.again:                 False                                                           (bool)
env.termination:           False                                                           (bool)
env.weaker:                1.0                                                             (float)
env.seed:                  0                                                               (int)
replay:                    fixed                                                           (str)
replay_size:               1000000.0                                                       (float)
replay_chunk:              64                                                              (int)
replay_fixed.prio_starts:  0.0                                                             (float)
replay_fixed.prio_ends:    1.0                                                             (float)
replay_fixed.sync:         0                                                               (int)
replay_consec.sync:        0                                                               (int)
replay_prio.prio_starts:   0.0                                                             (float)
replay_prio.prio_ends:     1.0                                                             (float)
replay_prio.sync:          0                                                               (int)
replay_prio.fraction:      0.1                                                             (float)
replay_prio.softmax:       False                                                           (bool)
replay_prio.temp:          1.0                                                             (float)
replay_prio.constant:      0.0                                                             (float)
replay_prio.exponent:      0.5                                                             (float)
tf.jit:                    True                                                            (bool)
tf.platform:               gpu                                                             (str)
tf.precision:              16                                                              (int)
tf.debug_nans:             False                                                           (bool)
tf.logical_gpus:           0                                                               (int)
tf.dist_dataset:           False                                                           (bool)
tf.dist_policy:            False                                                           (bool)
tf.tensorfloat:            True                                                            (bool)
tf.placement:              False                                                           (bool)
tf.growth:                 True                                                            (bool)
eval_dir:                                                                                  (str)
filter:                    .*                                                              (str)
tbtt:                      0                                                               (int)
train.steps:               100000000.0                                                     (float)
train.expl_until:          0                                                               (int)
train.log_every:           10000.0                                                         (float)
train.eval_every:          30000.0                                                         (float)
train.eval_eps:            1                                                               (int)
train.eval_samples:        1                                                               (int)
train.train_every:         16                                                              (int)
train.train_steps:         1                                                               (int)
train.train_fill:          10000.0                                                         (float)
train.eval_fill:           10000.0                                                         (float)
train.pretrain:            1                                                               (int)
train.log_zeros:           False                                                           (bool)
train.log_keys_video:      [image]                                                         (strs)
train.log_keys_sum:        ^$                                                              (str)
train.log_keys_mean:       ^$                                                              (str)
train.log_keys_max:        ^$                                                              (str)
train.log_timings:         True                                                            (bool)
train.sync_every:          180                                                             (int)
task_behavior:             Hierarchy                                                       (str)
expl_behavior:             None                                                            (str)
batch_size:                16                                                              (int)
transform_rewards:         off                                                             (str)
expl_noise:                0.0                                                             (float)
eval_noise:                0.0                                                             (float)
eval_state_mean:           False                                                           (bool)
priority:                  reward_loss                                                     (str)
priority_correct:          0.0                                                             (float)
data_loader:               tfdata                                                          (str)
grad_heads:                [decoder, reward, cont]                                         (strs)
rssm.units:                1024                                                            (int)
rssm.deter:                1024                                                            (int)
rssm.stoch:                32                                                              (int)
rssm.classes:              32                                                              (int)
rssm.act:                  elu                                                             (str)
rssm.norm:                 layer                                                           (str)
rssm.initial:              learned2                                                        (str)
rssm.unroll:               True                                                            (bool)
encoder.mlp_keys:          $^                                                              (str)
encoder.cnn_keys:          image                                                           (str)
encoder.act:               elu                                                             (str)
encoder.norm:              layer                                                           (str)
encoder.mlp_layers:        4                                                               (int)
encoder.mlp_units:         512                                                             (int)
encoder.cnn:               simple                                                          (str)
encoder.cnn_depth:         64                                                              (int)
encoder.cnn_kernels:       [4, 4, 4, 4]                                                    (ints)
decoder.mlp_keys:          $^                                                              (str)
decoder.cnn_keys:          image                                                           (str)
decoder.act:               elu                                                             (str)
decoder.norm:              layer                                                           (str)
decoder.mlp_layers:        4                                                               (int)
decoder.mlp_units:         512                                                             (int)
decoder.cnn:               simple                                                          (str)
decoder.cnn_depth:         64                                                              (int)
decoder.cnn_kernels:       [5, 5, 6, 6]                                                    (ints)
decoder.image_dist:        mse                                                             (str)
decoder.inputs:            [deter, stoch]                                                  (strs)
reward_head.layers:        4                                                               (int)
reward_head.units:         512                                                             (int)
reward_head.act:           elu                                                             (str)
reward_head.norm:          layer                                                           (str)
reward_head.dist:          symlog                                                          (str)
reward_head.outscale:      0.1                                                             (float)
reward_head.inputs:        [deter, stoch]                                                  (strs)
cont_head.layers:          4                                                               (int)
cont_head.units:           512                                                             (int)
cont_head.act:             elu                                                             (str)
cont_head.norm:            layer                                                           (str)
cont_head.dist:            binary                                                          (str)
cont_head.outscale:        0.1                                                             (float)
cont_head.inputs:          [deter, stoch]                                                  (strs)
loss_scales.kl:            1.0                                                             (float)
loss_scales.image:         1.0                                                             (float)
loss_scales.reward:        1.0                                                             (float)
loss_scales.cont:          1.0                                                             (float)
model_opt.opt:             adam                                                            (str)
model_opt.lr:              0.0001                                                          (float)
model_opt.eps:             1e-06                                                           (float)
model_opt.clip:            100.0                                                           (float)
model_opt.wd:              0.01                                                            (float)
model_opt.wd_pattern:      kernel                                                          (str)
wmkl.impl:                 mult                                                            (str)
wmkl.scale:                0.1                                                             (float)
wmkl.target:               3.5                                                             (float)
wmkl.min:                  1e-05                                                           (float)
wmkl.max:                  1.0                                                             (float)
wmkl.vel:                  0.1                                                             (float)
wmkl_balance:              0.8                                                             (float)
actor.layers:              4                                                               (int)
actor.units:               512                                                             (int)
actor.act:                 elu                                                             (str)
actor.norm:                layer                                                           (str)
actor.minstd:              0.03                                                            (float)
actor.maxstd:              1.0                                                             (float)
actor.outscale:            0.1                                                             (float)
actor.unimix:              0.01                                                            (float)
actor.inputs:              [deter, stoch]                                                  (strs)
critic.layers:             4                                                               (int)
critic.units:              512                                                             (int)
critic.act:                elu                                                             (str)
critic.norm:               layer                                                           (str)
critic.dist:               symlog                                                          (str)
critic.outscale:           0.1                                                             (float)
critic.inputs:             [deter, stoch]                                                  (strs)
actor_opt.opt:             adam                                                            (str)
actor_opt.lr:              0.0001                                                          (float)
actor_opt.eps:             1e-06                                                           (float)
actor_opt.clip:            100.0                                                           (float)
actor_opt.wd:              0.01                                                            (float)
actor_opt.wd_pattern:      kernel                                                          (str)
critic_opt.opt:            adam                                                            (str)
critic_opt.lr:             0.0001                                                          (float)
critic_opt.eps:            1e-06                                                           (float)
critic_opt.clip:           100.0                                                           (float)
critic_opt.wd:             0.01                                                            (float)
critic_opt.wd_pattern:     kernel                                                          (str)
actor_dist_disc:           onehot                                                          (str)
actor_dist_cont:           normal                                                          (str)
episodic:                  True                                                            (bool)
discount:                  0.99                                                            (float)
imag_discount:             0.99                                                            (float)
imag_horizon:              16                                                              (int)
imag_unroll:               True                                                            (bool)
critic_return:             gve                                                             (str)
actor_return:              gve                                                             (str)
return_lambda:             0.95                                                            (float)
actor_grad_disc:           reinforce                                                       (str)
actor_grad_cont:           backprop                                                        (str)
slow_target:               True                                                            (bool)
slow_target_update:        100                                                             (int)
slow_target_fraction:      1.0                                                             (float)
actent.impl:               mult                                                            (str)
actent.scale:              0.003                                                           (float)
actent.target:             0.5                                                             (float)
actent.min:                1e-05                                                           (float)
actent.max:                100.0                                                           (float)
actent.vel:                0.1                                                             (float)
actent_norm:               True                                                            (bool)
actent_perdim:             True                                                            (bool)
advnorm.impl:              mean_std                                                        (str)
advnorm.decay:             0.99                                                            (float)
advnorm.max:               100000000.0                                                     (float)
retnorm.impl:              std                                                             (str)
retnorm.decay:             0.999                                                           (float)
retnorm.max:               100.0                                                           (float)
scorenorm.impl:            off                                                             (str)
scorenorm.decay:           0.99                                                            (float)
scorenorm.max:             100000000.0                                                     (float)
adv_slow_critic:           True                                                            (bool)
pengs_qlambda:             False                                                           (bool)
critic_type:               vfunction                                                       (str)
rewnorm_discount:          False                                                           (bool)
env_skill_duration:        8                                                               (int)
train_skill_duration:      8                                                               (int)
skill_shape:               [8, 8]                                                          (ints)
manager_rews.extr:         1.0                                                             (float)
manager_rews.expl:         0.1                                                             (float)
manager_rews.goal:         0.0                                                             (float)
worker_rews.extr:          0.0                                                             (float)
worker_rews.expl:          0.0                                                             (float)
worker_rews.goal:          1.0                                                             (float)
worker_inputs:             [deter, stoch, goal]                                            (strs)
worker_report_horizon:     64                                                              (int)
skill_proposal:            manager                                                         (str)
goal_proposal:             replay                                                          (str)
goal_reward:               cosine_max                                                      (str)
goal_encoder.layers:       4                                                               (int)
goal_encoder.units:        512                                                             (int)
goal_encoder.act:          elu                                                             (str)
goal_encoder.norm:         layer                                                           (str)
goal_encoder.dist:         onehot                                                          (str)
goal_encoder.outscale:     0.1                                                             (float)
goal_encoder.unimix:       0.0                                                             (float)
goal_encoder.inputs:       [goal]                                                          (strs)
goal_decoder.layers:       4                                                               (int)
goal_decoder.units:        512                                                             (int)
goal_decoder.act:          elu                                                             (str)
goal_decoder.norm:         layer                                                           (str)
goal_decoder.dist:         mse                                                             (str)
goal_decoder.outscale:     0.1                                                             (float)
goal_decoder.inputs:       [skill]                                                         (strs)
worker_goals:              [manager]                                                       (strs)
jointly:                   new                                                             (str)
vae_imag:                  False                                                           (bool)
vae_replay:                True                                                            (bool)
vae_span:                  False                                                           (bool)
encdec_kl.impl:            mult                                                            (str)
encdec_kl.scale:           0.0                                                             (float)
encdec_kl.target:          10.0                                                            (float)
encdec_kl.min:             1e-05                                                           (float)
encdec_kl.max:             1.0                                                             (float)
encdec_opt.opt:            adam                                                            (str)
encdec_opt.lr:             0.0001                                                          (float)
encdec_opt.eps:            1e-06                                                           (float)
encdec_opt.clip:           100.0                                                           (float)
encdec_opt.wd:             0.01                                                            (float)
encdec_opt.wd_pattern:     kernel                                                          (str)
explorer:                  False                                                           (bool)
explorer_repeat:           False                                                           (bool)
expl_rew:                  adver                                                           (str)
manager_dist:              onehot                                                          (str)
manager_grad:              reinforce                                                       (str)
manager_actent:            0.5                                                             (float)
adver_impl:                squared                                                         (str)
manager_delta:             False                                                           (bool)
goal_kl:                   True                                                            (bool)
expl_rewards.extr:         0.0                                                             (float)
expl_rewards.disag:        0.0                                                             (float)
expl_rewards.vae:          0.0                                                             (float)
expl_rewards.ctrl:         0.0                                                             (float)
expl_rewards.pbe:          0.0                                                             (float)
expl_discount:             0.99                                                            (float)
expl_retnorm.impl:         std                                                             (str)
expl_retnorm.decay:        0.999                                                           (float)
expl_retnorm.max:          100000000.0                                                     (float)
expl_scorenorm.impl:       off                                                             (str)
expl_scorenorm.decay:      0.999                                                           (float)
expl_scorenorm.max:        100000000.0                                                     (float)
disag_head.layers:         4                                                               (int)
disag_head.units:          512                                                             (int)
disag_head.act:            elu                                                             (str)
disag_head.norm:           layer                                                           (str)
disag_head.dist:           mse                                                             (str)
disag_head.inputs:         [deter, stoch, action]                                          (strs)
expl_opt.opt:              adam                                                            (str)
expl_opt.lr:               0.0001                                                          (float)
expl_opt.eps:              1e-06                                                           (float)
expl_opt.clip:             100.0                                                           (float)
expl_opt.wd:               0.01                                                            (float)
disag_target:              [stoch]                                                         (strs)
disag_models:              8                                                               (int)
ctrl_embed.layers:         3                                                               (int)
ctrl_embed.units:          512                                                             (int)
ctrl_embed.act:            elu                                                             (str)
ctrl_embed.norm:           layer                                                           (str)
ctrl_embed.dist:           mse                                                             (str)
ctrl_embed.inputs:         [deter, stoch]                                                  (strs)
ctrl_head.layers:          1                                                               (int)
ctrl_head.units:           128                                                             (int)
ctrl_head.act:             elu                                                             (str)
ctrl_head.norm:            layer                                                           (str)
ctrl_head.dist:            mse                                                             (str)
ctrl_head.inputs:          [current, next]                                                 (strs)
ctrl_size:                 32                                                              (int)
ctrl_opt.opt:              adam                                                            (str)
ctrl_opt.lr:               0.0001                                                          (float)
ctrl_opt.eps:              1e-06                                                           (float)
ctrl_opt.clip:             100.0                                                           (float)
ctrl_opt.wd:               0.01                                                            (float)
expl_enc.layers:           4                                                               (int)
expl_enc.units:            512                                                             (int)
expl_enc.act:              elu                                                             (str)
expl_enc.norm:             layer                                                           (str)
expl_enc.dist:             onehot                                                          (str)
expl_enc.outscale:         0.1                                                             (float)
expl_enc.inputs:           [deter]                                                         (strs)
expl_enc.shape:            [8, 8]                                                          (ints)
expl_dec.layers:           4                                                               (int)
expl_dec.units:            512                                                             (int)
expl_dec.act:              elu                                                             (str)
expl_dec.norm:             layer                                                           (str)
expl_dec.dist:             mse                                                             (str)
expl_dec.outscale:         0.1                                                             (float)
expl_kl.impl:              mult                                                            (str)
expl_kl.scale:             0.1                                                             (float)
expl_kl.target:            10.0                                                            (float)
expl_kl.min:               0.01                                                            (float)
expl_kl.max:               1.0                                                             (float)
expl_kl.vel:               0.1                                                             (float)
expl_vae_elbo:             False                                                           (bool)
Encoder CNN shapes: {'image': (64, 64, 3)}
Encoder MLP shapes: {}
Decoder CNN shapes: {'image': (64, 64, 3)}
Decoder MLP shapes: {}
Synced last 0/0 trajectories.
Synced last 0/0 trajectories.
Synced last 0/0 trajectories.
Synced last 0/0 trajectories.
Logdir /vol/bitbucket/jk3417/explainable-mbhrl/logdir/20230405-143423
Fill eval dataset (10000.0 steps).
Saved episode: 20230405T133511-8e5509d9754a476fb2636f501617bed8-len1001-rew37.npz
Saved episode: 20230405T133511-76aeed17b0df4729afacaa8b13c5c46b-len1001-rew29.npz
Saved episode: 20230405T133511-9d4c115027fc49a6b583457d90c9266a-len1001-rew30.npz
Saved episode: 20230405T133512-92b7b158b5b14bb0adc28378a71a4866-len1001-rew31.npz
Saved episode: 20230405T133517-c6a004d916a04fdeb7dd3f0720cbdb2d-len1001-rew30.npz
Saved episode: 20230405T133517-75727e8b23684c0685fbf5416aedc5b9-len1001-rew36.npz
Saved episode: 20230405T133517-378bb403ce98402aaa47a6c4f011aeea-len1001-rew32.npz
Saved episode: 20230405T133517-aa15bef232ef4e428a65ac7a47d5fd0b-len1001-rew31.npz
Fill train dataset (10000.0 steps).
Episode has 1000 steps and return 28.3.
────────────────────────────────── Step 4004 ───────────────────────────────────
episode/length 1000 / episode/score 28.3 / episode/reward_rate 0.01 / 
replay/replay_steps 4004 / replay/replay_trajs 4

Episode has 1000 steps and return 29.3.
────────────────────────────────── Step 4004 ───────────────────────────────────
episode/length 1000 / episode/score 29.32 / episode/reward_rate 0.01 / 
replay/replay_steps 4004 / replay/replay_trajs 4

Saved episode: 20230405T133526-1f8d6d7bc56d47d1b432ea6334dac5fd-len1001-rew28.npz
Saved episode: 20230405T133526-6b36b6d5a38d43339adb5d83ed014fee-len1001-rew29.npz
Saved episode: 20230405T133526-ceca6245e6424f62b58dba34b224b3c4-len1001-rew32.npz
Saved episode: 20230405T133526-2ae7e40120ad4d98ae1961809edf1689-len1001-rew38.npz
Episode has 1000 steps and return 32.1.
────────────────────────────────── Step 4004 ───────────────────────────────────
episode/length 1000 / episode/score 32.07 / episode/reward_rate 0.01 / 
replay/replay_steps 4004 / replay/replay_trajs 4

Episode has 1000 steps and return 38.8.
────────────────────────────────── Step 4004 ───────────────────────────────────
episode/length 1000 / episode/score 38.79 / episode/reward_rate 0.05 / 
replay/replay_steps 4004 / replay/replay_trajs 4

Episode has 1000 steps and return 33.0.
────────────────────────────────── Step 8008 ───────────────────────────────────
episode/length 1000 / episode/score 33.03 / episode/reward_rate 0.03 / 
replay/replay_steps 8008 / replay/replay_trajs 8

Episode has 1000 steps and return 30.7.
────────────────────────────────── Step 8008 ───────────────────────────────────
episode/length 1000 / episode/score 30.68 / episode/reward_rate 0.01 / 
replay/replay_steps 8008 / replay/replay_trajs 8

Episode has 1000 steps and return 31.6.
────────────────────────────────── Step 8008 ───────────────────────────────────
episode/length 1000 / episode/score 31.56 / episode/reward_rate 0.04 / 
replay/replay_steps 8008 / replay/replay_trajs 8

Episode has 1000 steps and return 35.7.
────────────────────────────────── Step 8008 ───────────────────────────────────
episode/length 1000 / episode/score 35.71 / episode/reward_rate 0.04 / 
replay/replay_steps 8008 / replay/replay_trajs 8
